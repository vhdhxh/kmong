<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.longlive.kmong.DAO.Board">
    <insert id="insertboard" parameterType="com.longlive.kmong.DTO.BoardDTO">
        INSERT INTO board
        (board_Id,
        board_title,
        board_contents,
        board_thumbnail,
        board_price,
        user_Id

        )
        values (
        null,
        #{board_title},
        #{board_contents},
        #{board_thumbnail},
        #{board_price},
        #{user_Id}
        )
        <selectKey resultType="Long" keyProperty="boardId" keyColumn="board_id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>

    </insert>
    <!-- 게시글 리스트 조회 -->
    <select id="findAll" parameterType="com.longlive.kmong.DTO.SearchDto" resultType="com.longlive.kmong.DTO.BoardListDto">
        SELECT
        board_id,board_title,board_price,board_thumbnail
        FROM
        board
        <if test="keyword != null and keyword != ''">
        where
        (
        board_title LIKE CONCAT('%', #{keyword}, '%')
        OR board_contents LIKE CONCAT('%', #{keyword}, '%')
        )
        </if>
        ORDER BY
        board_id DESC
        LIMIT #{pagination.limitStart}, #{recordSize}
    </select>
    <!-- 게시글 수 카운팅 -->
    <select id="count" parameterType="com.longlive.kmong.DTO.SearchDto" resultType="int">
        SELECT
        COUNT(*)
        FROM
        board
        <if test="keyword != null and keyword != ''">
        where
        (
        board_title LIKE CONCAT('%', #{keyword}, '%')
        OR board_contents LIKE CONCAT('%', #{keyword}, '%')
        )
        </if>

    </select>
<!--    게시글상세보기-->
    <select id="findPost" parameterType="String" resultType="com.longlive.kmong.DTO.BoardDTO">
        select *
        from
        board
        where board_id = #{board_id}


    </select>
</mapper>